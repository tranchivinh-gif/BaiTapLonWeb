<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°n Ch·∫°y</title>

    <link rel="stylesheet" href="../CSS/bootstrap.min.css">
    <link rel="stylesheet" href="../fontawesomefree/css/all.min.css">
    <link rel="stylesheet" href="../CSS/style.css">

    <script src="../JS/jquery.js"></script>
    <script src="../JS/bootstrap.bundle.min.js"></script>
    <script src="../JS/banchay.js" defer></script>

    <style>
    body { background-color: #f9f9f9; }

    .main-container {
      display: grid;
      grid-template-columns: 250px 1fr;
      gap: 25px;
      padding: 30px 50px;
    }

    /* Sidebar */
    .sidebar {
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 20px;
      height: fit-content;
    }
    .sidebar h5 {
      color: #ff6f61;
      font-weight: bold;
      margin-bottom: 15px;
      text-transform: uppercase;
      font-size: 15px;
    }
    .sidebar ul { list-style: none; padding-left: 0; }
    .sidebar ul li {
      margin: 6px 0;
      cursor: pointer;
      color: #333;
      font-size: 15px;
    }
    .sidebar ul li:hover { color: #ff6f61; }

    .price-filter label {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      cursor: pointer;
      font-size: 15px;
    }
    .price-filter input {
      margin-right: 8px;
      accent-color: #ff6f61;
      transform: scale(1.1);
    }

    /* Sort bar */
    .sort-bar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 10px 15px;
      margin-bottom: 20px;
    }

    .sort-select {
      border: 1px solid #ccc;
      border-radius: 20px;
      padding: 6px 12px;
      font-size: 14px;
      color: #555;
      background-color: #fff;
      transition: all 0.2s;
    }
    .sort-select:focus {
      border-color: #ff6f61;
      box-shadow: 0 0 4px #ffb0a3;
      outline: none;
    }

    /* Hi·ªÉn th·ªã gi·ªëng Fahasa */
    #displaySelect {
      font-size: 14px;
      padding: 4px 0;
      border: none;
      appearance: none;
      background-image: url("data:image/svg+xml;utf8,<svg fill='%23666' height='10' width='10' xmlns='http://www.w3.org/2000/svg'><polygon points='0,0 10,0 5,7'/></svg>");
      background-repeat: no-repeat;
      background-position: right 4px center;
      background-size: 10px;
      cursor: pointer;
    }
    #displaySelect:focus { outline: none; }
    .display-wrapper {
      border: 1px solid #ddd;
      border-radius: 50px;
      background-color: #fff;
      padding: 3px 10px;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: border-color 0.2s;
    }
    .display-wrapper:hover {
      border-color: #ff6f61;
    }

    /* Banner */
    .banner {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
    }
    .banner img {
      width: 100%;
      border-radius: 10px;
      object-fit: cover;
    }

    /* Book grid */
    .book-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
    }

    .book-card {
      background-color: #fff;
      border: 1px solid #ddd;
      border-radius: 10px;
      overflow: hidden;
      transition: 0.3s;
      text-align: center;
    }
    .book-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    .book-card img {
      height: 220px;
      width: 100%;
      object-fit: cover;
    }
    .book-card h6 {
      margin-top: 10px;
      font-weight: 600;
      padding: 0 8px;
      min-height: 48px;
      font-size: 14px;
    }
    .price { color: #d9534f; font-weight: bold; margin-bottom: 5px; }
    .sold { font-size: 0.9em; color: #777; }
    .badge-hot {
      background-color: #ff6f61;
      color: white;
      font-size: 0.8em;
      border-radius: 6px;
      padding: 3px 7px;
      display: inline-block;
      margin-top: 8px;
    }
  </style>
</head>

<body>
<!-- HEADER -->
    <div class="header">
        <div class="logo">
            <a href="./tranggioithieu.html">
                <img src="../IMG/logo.png" alt="logo">
            </a>
        </div>
        <div class="search-box">
            <input type="text" placeholder="T√¨m s·∫£n ph·∫©m..." class="search-input">
            <div class="search-results"></div>
        </div>
        <div class="nav">
            <a href="./trangchu.html">Trang Ch·ªß</a>
            <a href="./trangsachmoi.html">S√°ch M·ªõi</a>
            <a href="./trangbanchay.html">B√°n Ch·∫°y</a>
            <a href="./danhmucsanpham.html">Danh M·ª•c</a>
            <a href="./trangkhuyenmai.html">Khuy·∫øn M√£i</a>
        </div>
        <div class="user-cart">
            <a href="./tranggiohang.html" class="cart-link position-relative">
                <i class="fa-solid fa-cart-shopping"></i> Gi·ªè h√†ng
                <span id="cart-count"
                    class="badge bg-danger position-absolute top-0 start-100 translate-middle rounded-pill"
                    style="font-size: 10px;">0</span>
            </a>

            <a href="./trangdangnhap.html"><i class="fa-solid fa-user"></i> ƒêƒÉng nh·∫≠p</a>
        </div>
    </div>

    <!-- ===== N·ªòI DUNG TRANG B√ÅN CH·∫†Y ===== -->
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
        <h5>Nh√≥m s·∫£n ph·∫©m</h5>
        <ul>
            <li>T·∫•t c·∫£ s·∫£n ph·∫©m</li>
            <li>S√°ch thi·∫øu nhi</li>
            <li>Gi√°o khoa - Tham kh·∫£o</li>
            <li>VƒÉn h·ªçc</li>
            <li>T√¢m l√Ω - K·ªπ nƒÉng s·ªëng</li>
            <li>Kinh t·∫ø</li>
        </ul>

        <h5 class="mt-4">Gi√°</h5>
        <div class="price-filter">
            <label><input type="checkbox" /> 0ƒë - 150.000ƒë</label>
            <label><input type="checkbox" /> 150.000ƒë - 300.000ƒë</label>
            <label><input type="checkbox" /> 300.000ƒë - 500.000ƒë</label>
            <label><input type="checkbox" /> 500.000ƒë - 700.000ƒë</label>
            <label><input type="checkbox" /> Tr√™n 700.000ƒë</label>
        </div>
        </div>

        <!-- Content -->
        <div>
        <div class="banner">
            <img src="../IMG/Hau1.png" alt="Banner 1" />
            <img src="../IMG/Hau1.png" alt="Banner 2" />
        </div>

        <!-- Sort Bar -->
        <div class="sort-bar">
            <div class="d-flex align-items-center justify-content-end w-100 gap-3">
            <!-- √î 1: S·∫Øp x·∫øp -->
            <div class="d-flex align-items-center">
                <label for="sortSelect" class="me-2 fw-semibold text-secondary">S·∫Øp x·∫øp theo:</label>
                <select id="sortSelect" class="sort-select">
                <option value="banchay">B√°n ch·∫°y nh·∫•t</option>
                <option value="giaTang">Gi√° tƒÉng d·∫ßn</option>
                <option value="giaGiam">Gi√° gi·∫£m d·∫ßn</option>
                <option value="ten">T√™n (A-Z)</option>
                </select>
            </div>

            <!-- √î 2: Hi·ªÉn th·ªã -->
            <div class="d-flex align-items-center gap-2">
                <label class="fw-semibold text-secondary mb-0">Hi·ªÉn th·ªã:</label>
                <div class="display-wrapper" id="displayCountBox">
                    <i class="fa-solid fa-grip text-muted"></i>
                    <span id="displayCount" class="fw-semibold text-secondary">0</span>
                    <span class="text-secondary" style="font-size: 14px;"></span>
                </div>
            </div>
            </div>
        </div>

        <!-- Danh s√°ch s√°ch -->
        <div class="book-grid" id="book-list"></div>
        </div>
  </div>
    <!-- FOOTER -->
    <div class="footer">
        <div>
            <h3>V·ªÅ Ch√∫ng T√¥i</h3>
            <ul>
                <li><a href="./trangsitemap.html">Site Map</a></li>
                <li><a href="#">Gi·ªõi thi·ªáu</a></li>
                <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                <li><a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
            </ul>
        </div>

        <div>
            <h3>H·ªó Tr·ª£ Kh√°ch H√†ng</h3>
            <ul>
                <li><a href="#">Trung t√¢m tr·ª£ gi√∫p</a></li>
                <li><a href="#">H∆∞·ªõng d·∫´n mua h√†ng</a></li>
                <li><a href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
                <li><a href="#">Li√™n h·ªá</a></li>
            </ul>
        </div>

        <div>
            <h3>K·∫øt N·ªëi V·ªõi Ch√∫ng T√¥i</h3>
            <div class="social-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
            </div>
            <p style="margin-top:10px; font-size:14px;">üìû Hotline: 1900 1234<br>‚úâÔ∏è Email: T√™n_Nh√†_S√°ch@bookstore.vn
            </p>
        </div>
    </div>
    
    <script>
        // L·∫•y d·ªØ li·ªáu mua h√†ng t·ª´ localStorage
        let purchases = JSON.parse(localStorage.getItem("purchases")) || [];
        const container = document.getElementById("book-list");
        const displaySelect = document.getElementById("displaySelect");

        if (purchases.length === 0) {
        container.innerHTML = `<div class="text-center text-muted col-12">Ch∆∞a c√≥ d·ªØ li·ªáu mua h√†ng ƒë·ªÉ th·ªëng k√™.</div>`;
        } else {
        // ƒê·∫øm l∆∞·ª£t mua m·ªói s√°ch
        let thongKe = {};
        purchases.forEach(sp => {
            if (!thongKe[sp.id]) thongKe[sp.id] = { ...sp, luotMua: 0 };
            thongKe[sp.id].luotMua++;
        });

        // Danh s√°ch ƒë√£ s·∫Øp x·∫øp
        let ds = Object.values(thongKe).sort((a, b) => b.luotMua - a.luotMua);

        // Hi·ªÉn th·ªã t·ªïng s·ªë s·∫£n ph·∫©m t·ª± ƒë·ªông
        document.getElementById("displayCount").textContent = ds.length;

        // T·ª± ƒë·ªông t·∫°o dropdown ‚ÄúHi·ªÉn th·ªã‚Äù
        displaySelect.innerHTML = "";
        const total = ds.length;
        const options = [];
        if (total <= 24) {
            options.push({ value: total, text: `Hi·ªÉn th·ªã ${total}` });
        } else if (total <= 48) {
            options.push({ value: 24, text: "Hi·ªÉn th·ªã 24" });
            options.push({ value: total, text: `Hi·ªÉn th·ªã ${total}` });
        } else {
            options.push({ value: 24, text: "Hi·ªÉn th·ªã 24" });
            options.push({ value: 48, text: "Hi·ªÉn th·ªã 48" });
            options.push({ value: total, text: `Hi·ªÉn th·ªã ${total}` });
        }
        options.forEach(opt => {
            const o = document.createElement("option");
            o.value = opt.value;
            o.textContent = opt.text;
            displaySelect.appendChild(o);
        });

        function render(limit) {
            container.innerHTML = "";
            ds.slice(0, limit).forEach((book, i) => {
            const card = document.createElement("div");
            card.className = "book-card";
            card.innerHTML = `
                ${i === 0 ? `<span class='badge-hot'>B√°n ch·∫°y nh·∫•t</span>` : ""}
                <img src="${book.img}" alt="${book.ten}">
                <h6>${book.ten}</h6>
                <p class="price">${book.gia.toLocaleString()}ƒë</p>
                <p class="sold">ƒê√£ b√°n: ${book.luotMua}</p>
            `;
            container.appendChild(card);
            });
        }

        render(Math.min(24, total));
        displaySelect.addEventListener("change", e => render(parseInt(e.target.value)));
        }
    </script>
</body>

</html>
<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°n Ch·∫°y</title>

    <link rel="stylesheet" href="../CSS/bootstrap.min.css">
    <link rel="stylesheet" href="../fontawesomefree/css/all.min.css">
    <link rel="stylesheet" href="../CSS/style.css">

    <script src="../JS/jquery.js"></script>
    <script src="../JS/bootstrap.bundle.min.js"></script>
    <script src="../JS/banchay.js" defer></script>
</head>

<body>
    <!-- ===== HEADER ===== -->
    <div class="header">
        <div class="logo">
            <a href="./tranggioithieu.html">
                <img src="../IMG/logo.png" alt="logo">
            </a>
        </div>

        <div class="search-box">
            <input type="text" placeholder="T√¨m s·∫£n ph·∫©m..." class="search-input">
        </div>

        <div class="nav">
            <a href="./trangchu.html">Trang Ch·ªß</a>
            <a href="./trangsachmoi.html">S√°ch M·ªõi</a>
            <a href="./trangbanchay.html">B√°n Ch·∫°y</a>
            <a href="./danhmucsanpham.html">Danh M·ª•c</a>
            <a href="./trangkhuyenmai.html">Khuy·∫øn M√£i</a>
        </div>

        <div class="user-cart">
            <a href="./tranggiohang.html"><i class="fa-solid fa-cart-shopping"></i> Gi·ªè h√†ng</a>
            <a href="./trangdangnhap.html"><i class="fa-solid fa-user"></i> ƒêƒÉng nh·∫≠p</a>
        </div>
    </div>

    <!-- ===== N·ªòI DUNG TRANG B√ÅN CH·∫†Y ===== -->
    <div class="content container my-5">
        <h2 class="mb-4 text-center text-danger">Th·ªëng K√™ S√°ch B√°n Ch·∫°y</h2>
        <div id="best-seller-banner"></div>
        <div class="row" id="book-list"></div>
    </div>
    <!-- ===== FOOTER ===== -->
    <div class="footer">
        <div>
            <h3>V·ªÅ Ch√∫ng T√¥i</h3>
            <ul>
                <li><a href="#">Gi·ªõi thi·ªáu</a></li>
                <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                <li><a href="#">ƒêi·ªÅu kho·∫£n s·ª≠ d·ª•ng</a></li>
                <li><a href="#">Ch√≠nh s√°ch b·∫£o m·∫≠t</a></li>
            </ul>
        </div>

        <div>
            <h3>H·ªó Tr·ª£ Kh√°ch H√†ng</h3>
            <ul>
                <li><a href="#">Trung t√¢m tr·ª£ gi√∫p</a></li>
                <li><a href="#">H∆∞·ªõng d·∫´n mua h√†ng</a></li>
                <li><a href="#">Ch√≠nh s√°ch ƒë·ªïi tr·∫£</a></li>
                <li><a href="#">Li√™n h·ªá</a></li>
            </ul>
        </div>

        <div>
            <h3>K·∫øt N·ªëi V·ªõi Ch√∫ng T√¥i</h3>
            <div class="social-icons">
                <a href="#"><i class="fa-brands fa-facebook"></i></a>
                <a href="#"><i class="fa-brands fa-instagram"></i></a>
            </div>
            <p style="margin-top:10px; font-size:14px;">üìû Hotline: 1900 1234<br>‚úâÔ∏è Email: Ten_Nha_Sach@bookstore.vn</p>
        </div>
    </div>
    <script>
        /*
Gi·∫£ s·ª≠ m·ªói l·∫ßn ng∆∞·ªùi d√πng mua 1 quy·ªÉn s√°ch, 
         h·ªá th·ªëng gi·ªè h√†ng s·∫Ω l∆∞u v√†o localStorage nh∆∞ sau: 
         localStorage.setItem("purchases", JSON.stringify([
             {id:1, ten:"ƒê·∫Øc Nh√¢n T√¢m"},
             {id:2, ten:"Nh√† Gi·∫£ Kim"},
             {id:1, ten:"ƒê·∫Øc Nh√¢n T√¢m"},
             {id:3, ten:"Mu√¥n Ki·∫øp Nh√¢n Sinh"}
         ]));
        */
        // ƒê·ªçc d·ªØ li·ªáu mua h√†ng t·ª´ localStorage
        let purchases = JSON.parse(localStorage.getItem("purchases")) || [];

        if (purchases.length === 0) {
            document.getElementById("book-list").innerHTML =
                `<div class="text-center text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu mua h√†ng ƒë·ªÉ th·ªëng k√™.</div>`;
        } else {
            // ƒê·∫øm s·ªë l∆∞·ª£t mua cho t·ª´ng s√°ch
            let thongKe = {};
            purchases.forEach(sp => {
                thongKe[sp.ten] = (thongKe[sp.ten] || 0) + 1;
            });

            // Chuy·ªÉn sang m·∫£ng v√† s·∫Øp x·∫øp theo l∆∞·ª£t mua gi·∫£m d·∫ßn
            let ketQua = Object.entries(thongKe)
                .map(([ten, luotMua]) => ({ ten, luotMua }))
                .sort((a, b) => b.luotMua - a.luotMua);

            // S√°ch b√°n ch·∫°y nh·∫•t
            let bestSeller = ketQua[0];

            // Hi·ªÉn th·ªã banner s√°ch b√°n ch·∫°y nh·∫•t
            document.getElementById("best-seller-banner").innerHTML =
                `<div class="alert alert-success text-center">
                    üî• <b>${bestSeller.ten}</b> l√† s√°ch b√°n ch·∫°y nh·∫•t v·ªõi ${bestSeller.luotMua} l∆∞·ª£t mua!
                </div>`;

            // Hi·ªÉn th·ªã danh s√°ch t·∫•t c·∫£ s√°ch theo l∆∞·ª£t mua
            const bookList = document.getElementById("book-list");
            ketQua.forEach(item => {
                const col = document.createElement("div");
                col.className = "col-md-3 mb-4";
                col.innerHTML = `
                    <div class="card shadow-sm h-100 text-center">
                        <div class="card-body">
                            <h5 class="card-title text-primary">${item.ten}</h5>
                            <p class="card-text">L∆∞·ª£t mua: <b>${item.luotMua}</b></p>
                        </div>
                    </div>
                `;
                bookList.appendChild(col);
            });
        }
    </script>
</body>

</html>